@page "/Admin/Status"
@using System.Globalization
@inherits ListPageBase<FormStatus, FormStatusRepository, FormStatusFilter>

<PageTitle>@Localizer.LIST_PAGE_TITLE</PageTitle>

<FluentStack HorizontalAlignment="HorizontalAlignment.End" Class="mb-2">
    <FluentAnchorButton Href="/Admin/Status/Create"
                  IconStart="@(new Icons.Regular.Size20.PersonAdd())"
                  Appearance="ButtonAppearance.Primary">
        @Localizer.NEW_STATUS
    </FluentAnchorButton>
</FluentStack>

<div class="row">
    <div class="col-lg-3 col-sm-12 order-lg-3 mb-3">
        <FluentCard>
            <FluentText Size="TextSize.Size600">@AppLocalizer.LABEL_SEARCH_FILTER</FluentText>

            <EditForm Model="Filter" OnValidSubmit="async () => await LoadAsync(true)">
                <FluentStack Orientation="Orientation.Vertical">
                    <FluentTextInput @bind-Value="Filter.SearchPhrase"
                                     Immediate="true"
                                     Label="@AppLocalizer.LABEL_SEARCHPHRASE"
                                     Placeholder="@Localizer.SEARCH_PHRASE_PLACEHOLDER"
                                     Autofocus />

                    <div class="d-flex justify-content-end mt-2 w-100">
                        <FluentButton Type="ButtonType.Submit"
                                      IconStart="@(new Icons.Regular.Size20.Search())"
                                      Appearance="ButtonAppearance.Primary">
                            @AppLocalizer.BUTTON_SEARCH
                        </FluentButton>
                    </div>
                </FluentStack>
            </EditForm>
        </FluentCard>
    </div>
    <div class="col-lg-9">
        <FluentStack Orientation="Orientation.Vertical" VerticalGap="@FluentConstants.FLUENTSTACK_VERTICAL_GAP">
            @if (_isLoading || Data is null)
            {
                <FluentSpinner />
            }
            else
            {
                @foreach (var item in Data.Items)
                {
                    var description = item.GetLocalization(CultureInfo.CurrentCulture);
                    <div class="list">
                        <div class="list-details">
                            <div class="list-item" hidden-when="xs sm">
                                <label>@AppLocalizer.LABEL_ID</label>
                                <span>@item.StatusId</span>
                            </div>
                            <div class="list-item">
                                <label>@Localizer.LABEL_NAME</label>
                                <span>@description?.Name</span>
                            </div>

                            <div class="list-item">
                                <label>@Localizer.LABEL_DESCRIPTION</label>
                                <span>@description?.Description</span>
                            </div>
                        </div>
                        <div class="list-buttons">
                            <FluentAnchorButton Href="@($"/Admin/Status/Edit?Id={item.GetIdentifier()}")">
                                @AppLocalizer.BUTTON_EDIT
                            </FluentAnchorButton>
                        </div>
                    </div>
                }

                @if (!_isLoading && !Data.Items.Any())
                {
                    <div class="list justify-content-center">
                        @AppLocalizer.NO_ENTRIES
                    </div>
                }

                <Pagination CurrentPageNumber="Page"
                            TotalItems="Data.Total"
                            ItemsPerPage="Filter.Limit"
                            NavUrl="/Admin/Status?page=" />

            }
        </FluentStack>
    </div>
</div>
